ggplot(ThesisData, aes(x = incomeGini, y = wealthGini)) + geom_point(aes(color = Region)) +
geom_smooth(aes(x = incomeGini, y = wealthGini), method = "lm", formula = y ~ x) + facet_wrap( ~ Year) +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")), formula = y ~ x, parse = T) +
geom_text(aes(label = ifelse(incomeGini > 40, Country, '')), hjust = 0.5) #clearly no relationship
# Yearly relationship between income and wealth
ggplot(ThesisData, aes(x = incomeGini, y = wealthGini)) + geom_point(aes(color = Region)) +
geom_smooth(aes(x = incomeGini, y = wealthGini), method = "lm", formula = y ~ x) + facet_wrap( ~ Year) +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")), formula = y ~ x, parse = T) +
geom_text(aes(label = ifelse(incomeGini > 40, Country, '')), vjust = 0.5) #clearly no relationship
# Yearly relationship between income and wealth
ggplot(ThesisData, aes(x = incomeGini, y = wealthGini)) + geom_point(aes(color = Region)) +
geom_smooth(aes(x = incomeGini, y = wealthGini), method = "lm", formula = y ~ x) + facet_wrap( ~ Year) +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")), formula = y ~ x, parse = T) +
geom_text(aes(label = ifelse(incomeGini > 40, Country, '')), vjust = -1) #clearly no relationship
# Income regressed on all OECD varibles
ThesisData %>% keep(is.numeric) %>% gather(-incomeGini, key = "var", value = "value") %>%
ggplot(aes(value, wealthGini)) + geom_point() + geom_smooth(method = "lm") + facet_wrap( ~ var, scales = "free") +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")), formula = y ~ x, parse = T)
# Income regressed on all OECD varibles
ThesisData %>% keep(is.numeric) %>% gather(-incomeGini, key = "var", value = "value") %>%
ggplot(aes(value, incomeGini)) + geom_point() + geom_smooth(method = "lm") + facet_wrap( ~ var, scales = "free") +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")), formula = y ~ x, parse = T)
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line()
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma)
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == 2019), color = "black", hjust = 0, size = 3, nudge_x = 0.5) +
guides(color = "none")
View(ThesisData)
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = 0, size = 3, nudge_x = 0.5) +
guides(color = "none")
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = 0, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(2010, 2020))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = 0, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c("2010-08-13", "2020-08-13"))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = 0, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = 1, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = -1, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = -0.5, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = -0.2, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"), color = "black", hjust = -0.1, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"),
color = "black", hjust = -0.05, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
??lodown
library(lodown)
install.packages("lodown")
library(lodown)
install_github( "ajdamico/lodown" , dependencies = TRUE )
install.packages("convey")
install.packages("srvyr")
library(survey)
library(convey)
library(lodown)
library(devtools)
install_github( "ajdamico/lodown" , dependencies = TRUE )
install.packages("XML")
library(XML)
library(xml2)
install_github( "ajdamico/lodown" , dependencies = TRUE )
ggplot(data = ThesisData, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar()
ggplot(data = ThesisData, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(stat = "identity")
ggplot(data = ThesisData, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
ggplot(data = ThesisData, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(aes(fill = Country), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none")
ggplot(data = ThesisData, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(aes(fill = Country), stat = "identity") +
scale_y_continuous(labels = scales::comma) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none")
# Figure 2
figure2data <- ThesisData %>% filter(Year == 2019)
ggplot(data = figure2data, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(aes(fill = Country), stat = "identity") +
scale_y_continuous(labels = scales::comma) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none")
# Figure 2
figure2data <- ThesisData %>% filter(Year == "2019-08-13")
ggplot(data = figure2data, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(aes(fill = Country), stat = "identity") +
scale_y_continuous(labels = scales::comma) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none")
ggplot(data = figure2data, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(aes(fill = Country), stat = "identity") +
scale_y_continuous(labels = scales::comma) + theme_bw() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none")
ggplot(data = figure2data, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(aes(fill = Country), stat = "identity") +
scale_y_continuous(labels = scales::comma) + theme_bw() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.y = "none")
ggplot(data = figure2data, aes(x = Country, y = `Mean Wealth per Adult`)) + geom_bar(aes(fill = Country), stat = "identity") +
scale_y_continuous(labels = scales::comma) + theme_bw() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
View(figure2data)
library(reshape2)
figure2data <- melt(figure2data, id.var = "Country", measure.vars = c("Mean Wealth per Adult","Median Wealth per Adult"))
View(figure2data)
ggplot(data = figure2data, aes(x = Country)) + geom_bar(aes(fill = Country), stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019")
View(figure2data)
ggplot(data = figure2data, aes(x = Country, y = value)) + geom_bar(aes(fill = Country), stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019")
ggplot(data = figure2data, aes(x = Country, y = value)) + geom_bar(aes(fill = Country), stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
View(figure2data)
ggplot(data = figure2data, aes(x = Country, y = value, fill = Country)) + geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = Country)) + geom_bar(stat = "identity", position = "dodge")# +
ggplot(data = figure2data, aes(x = Country, y = value, fill = Country)) + geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank()) + scale_color_manual(values = c("red","blue"))
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019")  + scale_color_manual(values = c("red","blue")) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_color_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.position = "none",
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "top",
axis.title.x = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank())
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title.position = "center")
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = Thesisdata, aes(x = incomeGini, y = wealthGini, color = Region)) + geom_point()
ggplot(data = ThesisData, aes(x = incomeGini, y = wealthGini, color = Region)) + geom_point()
# Figure 3b
ggplot(data = ThesisData, aes(x = incomeGini, y = wealthGini, color = Region)) + geom_point() + labs(x = "Income Gini", y = "Wealth Gini") +
theme_bw()
colnames(ThesisData)
# Figure 3a
figure3data <- ThesisData %>% filter(Year == "2019-08-13")
figure3data <- melt(figure2data, id.var = "Country", measure.vars = c("Under 10,000","10,000-100,000","100,000-1 Million","Over 1 Million"))
View(figure3data)
figure3data <- melt(figure3data, id.var = "Country", measure.vars = c("Under 10,000","10,000-100,000","100,000-1 Million","Over 1 Million"))
JohnDayData3 %>% filter(Measure != "#H", Measure != "Num_H") %>%
ggplot(aes(x = as.numeric(Year), y = Value, color = Measure)) + geom_line() + geom_point() +
scale_y_continuous(labels = scales::comma) +
geom_text(aes(label = Measure),
data = JohnDayData3 %>% filter(as.numeric(Year) == 2018 & Measure != "Num_H"),
color = "black",
hjust = 0,
size = 3,
nudge_x = 0.5) + guides(color = "none") + coord_cartesian(xlim = c(2003, 2022))
ggplot(data = BonnevilleDatavsODFW) + geom_line(aes(as.Date(paste0(Year, "-01-01")),ActualHSS), color = "red") +
geom_point(aes(as.Date(paste0(Year, "-01-01")),ActualHSS), color = "red") +
geom_point(aes(as.Date(paste0(Year, "-01-01")),Hatchery), color = "black") +
geom_line(aes(as.Date(paste0(Year, "-01-01")),Hatchery), color = "black") # ActualHSS is ODFW Count Hatchery is Bonneville Barged Numbers
formula = y ~ x + I(x^2)
ggplot(data = BonnevilleDatavsODFW, aes(Hatchery, ActualHSS)) + geom_point() + geom_smooth(method = "lm", se = F, formula = formula) +
stat_poly_eq(aes(label = paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")), formula = formula, parse = T) #This is good shit
lm1 <- lm(pHOSObserved ~ log(Num_H) + NOSA, data = JohnDayData2)
lm2 <- lm(pHOSObserved ~ `PercentHBarged` + NOSA, data = JohnDayData2) #Current model
stargazer(lm1, lm2, type = "text") # Check slide 20 for source on regression
summary(lm(ActualHSS ~ Hatchery + I(Hatchery^2), data = BonnevilleDatavsODFW))
stargazer(lm1, lm2, type = "text") # Check slide 20 for source on regression
ggplot(data = MadrasDataYearly, aes(x = Year, y = Temperature)) + geom_smooth(method = "lm", formula = formula, se = F) +
geom_line(aes(color = Season)) + facet_grid(Season ~ Group, scales = "free") +
stat_poly_eq(aes(label = paste(..rr.label..)), formula = formula, parse = T)
summary(lm(Temperature ~ (Group), data = MadrasDataYearlyFall))
summary(lm(Temperature ~ (Group), data = MadrasDataYearlyWinter))
summary(lm(Temperature ~ (Group), data = MadrasDataYearlySpring))
summary(lm(Temperature ~ (Group), data = MadrasDataYearlySummer))
Falllm <- summary(lm(Temperature ~ (Group), data = MadrasDataYearlyFall))
Winterlm <- summary(lm(Temperature ~ (Group), data = MadrasDataYearlyWinter))
Springlm <- summary(lm(Temperature ~ (Group), data = MadrasDataYearlySpring))
Summerlm <- summary(lm(Temperature ~ (Group), data = MadrasDataYearlySummer))
stargazer(Falllm,Winterlm,Springlm,Summerlm, type = "text")
View(figure3data)
figure3data <- melt(figure3data, id.vars = c("Country", "Region"), measure.vars = c("Under 10,000","10,000-100,000","100,000-1 Million","Over 1 Million"))
# Figure 3a
figure3data <- ThesisData %>% filter(Year == "2019-08-13")
figure3data <- melt(figure3data, id.vars = c("Country", "Region"), measure.vars = c("Under 10,000","10,000-100,000","100,000-1 Million","Over 1 Million"))
View(figure3data)
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue","forestgreen","chocolate","lavender")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5))
str(figure3data)
figure3data$value <- as.numeric(figure3data$value)
View(figure3data)
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue","forestgreen","chocolate","lavender")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") + facet_wrap( ~ Region)
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
facet_wrap( ~ Region) +
scale_fill_manual(values = c("red","blue","forestgreen","chocolate","lavender")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5))
View(figure3data)
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
facet_wrap( ~ Region) +
scale_fill_manual(values = c("red","blue","forestgreen","chocolate","lavender")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue","forestgreen","chocolate","lavender")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(palette = "Dark2") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_brewer(palette = "Dark2") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_brewer(palette = "Reds") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_brewer(palette = "Blues") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity") +
scale_fill_brewer(palette = "Blues") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
figure2data <- melt(figure2data, id.var = "Country", measure.vars = c("Mean Wealth per Adult","Median Wealth per Adult"))
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5))
# Figure 4
figure4data <- ThesisData %>% filter(Year == "2018-08-13")
figure4data <- melt(figure4data, id.var = "Country", measure.vars = c("incomeGini","wealthGini"))
ggplot(data = figure4data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("lavender","forestgreen")) + theme_bw() + labs(y = "Wealth Gini", x = "Income Gini") +
ggtitle("Wealth and Income Ginis in 2018") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5))
ggplot(data = figure4data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("purple","forestgreen")) + theme_bw() + labs(y = "Wealth Gini", x = "Income Gini") +
ggtitle("Wealth and Income Ginis in 2018") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5))
# Figure 4
figure4data <- ThesisData %>% filter(Year == "2017-08-13")
figure4data <- melt(figure4data, id.var = "Country", measure.vars = c("incomeGini","wealthGini"))
ggplot(data = figure4data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("purple","forestgreen")) + theme_bw() + labs(y = "Wealth Gini", x = "Income Gini") +
ggtitle("Wealth and Income Ginis in 2018") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5))
# Figure 4
figure4data <- ThesisData %>% filter(Year == "2016-08-13")
figure4data <- melt(figure4data, id.var = "Country", measure.vars = c("incomeGini","wealthGini"))
ggplot(data = figure4data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("purple","forestgreen")) + theme_bw() + labs(y = "Wealth Gini", x = "Income Gini") +
ggtitle("Wealth and Income Ginis in 2016") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5))
# Figure 4
figure4data <- ThesisData %>% filter(Year == "2017-08-13")
figure4data <- melt(figure4data, id.var = "Country", measure.vars = c("incomeGini","wealthGini"))
ggplot(data = figure4data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("purple","forestgreen")) + theme_bw() + labs(y = "Wealth Gini", x = "Income Gini") +
ggtitle("Wealth and Income Ginis in 2017") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5))
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line()
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line() + theme(legend.position = "none")
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line() + facet_wrap( ~ Country)
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line() + facet_wrap( ~ Country) +
theme(legend.position = "none") #Add 2008 and 2003
ggplot(data = ThesisData, aes(x = Year, y = incomeGini, color = Country)) + geom_line() + facet_wrap( ~ Country) +
theme(legend.position = "none") #Add 2018, 2019
# Figure 8
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line() + facet_wrap( ~ Country) +
theme(legend.position = "none") #Add 2008 and 2003
ggplot(data = ThesisData, aes(x = Year, y = incomeGini, color = Country)) + geom_line() + facet_wrap( ~ Country) +
theme(legend.position = "none") #Add 2018, 2019 and Australia, Chile, Colombia, Mexico, New Zealand needs to get filled in
# Figure 3b
ggplot(data = ThesisData, aes(x = incomeGini, y = wealthGini, color = Region)) + geom_point() + labs(x = "Income Gini", y = "Wealth Gini") +
theme_bw()
# Wealth regressed on all OECD variables
ThesisData %>% keep(is.numeric) %>% gather(-wealthGini, key = "var", value = "value") %>%
ggplot(aes(value, wealthGini)) + geom_point() + geom_smooth(method = "lm") + facet_wrap( ~ var, scales = "free") +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")), formula = y ~ x, parse = T)
# Income regressed on all OECD varibles
ThesisData %>% keep(is.numeric) %>% gather(-incomeGini, key = "var", value = "value") %>%
ggplot(aes(value, incomeGini)) + geom_point() + geom_smooth(method = "lm") + facet_wrap( ~ var, scales = "free") +
stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")), formula = y ~ x, parse = T)
ggplot(data = ThesisData, aes(x = Year, y = as.numeric(as.character(`Mean Wealth per Adult`)), color = Country)) + geom_line() +
scale_y_continuous(labels = scales::comma) + labs(y = "Mean Wealth per Adult") +
geom_text(aes(label = Country), data = ThesisData %>% filter(Year == "2019-08-13"),
color = "black", hjust = -0.05, size = 3, nudge_x = 0.5) +
guides(color = "none") + coord_cartesian(xlim = c(as.Date("2010-08-13"), as.Date("2020-08-13")))
ggplot(data = figure2data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("red","blue")) +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Mean vs. Median Wealth in 2019") +
ggtitle("Mean vs. Median Wealth in 2019") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5))
ggplot(data = figure3data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity") +
scale_fill_brewer(palette = "Blues") +
scale_y_continuous(labels = scales::comma) + theme_bw() + labs(y = "Percent in Group") +
ggtitle("Inequality Regionally and Grouped") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5))
# Figure 3b
ggplot(data = ThesisData, aes(x = incomeGini, y = wealthGini, color = Region)) + geom_point() + labs(x = "Income Gini", y = "Wealth Gini") +
theme_bw()
ggplot(data = figure4data, aes(x = Country, y = value, fill = variable)) + geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("purple","forestgreen")) + theme_bw() + labs(y = "Wealth Gini", x = "Income Gini") +
ggtitle("Wealth and Income Ginis in 2017") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
legend.title = element_blank(),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5)) # Reminder that we need to add income inequality gini's for 2017-2019 (WIID)
# Figure 8
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line() + facet_wrap( ~ Country) +
theme(legend.position = "none") #Add 2008 and 2003
# Figure 8
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line() +
geom_line(aes(x = Year, y = incomeGini, color = Country)) +
facet_wrap( ~ Country) +
theme(legend.position = "none") #Add 2008 and 2003
# Figure 8
ggplot(data = ThesisData, aes(x = Year, y = wealthGini, color = Country)) + geom_line() +
geom_line(aes(x = Year, y = incomeGini, color = Country), color = "black") +
facet_wrap( ~ Country) +
theme(legend.position = "none") #Add 2008 and 2003
